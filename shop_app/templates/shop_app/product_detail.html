{% extends 'base.html' %}

{% block main %}

<div class="d-flex col-4 justify-content-between">
    <h1 class="h2 mb-3 fw-normal">{{ product.product_name }}</h1>
</div>

<div class="row">
    <div class="col-md-5">
        <img class="w-100" src="{{ product.product_image.url }}" alt="">
    </div>
    <div class="col-4">
        <h2>{{ product.product_price }} Р</h2>

        <form action="{% url 'favorites_app:add_to_favorite' product.id %}" method="post" class="col-4 mt-2">
            {% csrf_token %}
            <input type="submit" value="В избранное" class="form-control">
        </form>

    </div>
</div>

<div class="row mt-5 col-5">
    <h2>Описание продукта</h2>
    <p>{{ product.product_desc }}</p>
</div>

<div class="row">
    <h2 class="mt-5">Отзывы</h2>
    <div class="col-7">
        {% for review in reviews %}
            {% for users in review_users %}
                {% if review.user_id == users.id %}
                    <div class="row bg-light p-2 mt-2">
                        <div class="col-8">
                            <h6>{{ users.user_name }}</h6>
                            <p>{{ review.review_text }}</p>
                        </div>
                        {% if user and user.id == review.user_id %}
                            <div class="row col-4 align-items-center">
                                <form action="{% url 'review_app:remove_review' review.id %}" method="post">
                                    {% csrf_token %}
                                    <input type="submit" value="Удалить отзыв" class="form-control">
                                </form>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        {% empty %}
            <p>Отзывов пока нет</p>
        {% endfor %}
    </div>

    <div class="col-7 mt-3">
        <form action="{% url 'review_app:add_review' product.id %}" method="post">
            {% csrf_token %}
            {{ review_form }}
            <input type="submit" value="Добавить отзыв" class="form-control mt-2">
        </form>
    </div>
</div>

{% endblock %}